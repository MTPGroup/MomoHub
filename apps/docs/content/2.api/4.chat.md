---
title: Chat
description: 聊天会话和消息 API
---

## 创建聊天

::endpoint{method="POST" path="/chats" auth}
创建一个新的聊天会话。
::

**请求参数：**

::field{name="characterId" type="string" required}
关联的角色 ID
::

::field{name="name" type="string"}
聊天会话名称
::

**响应数据：**

```json
{
  "id": "chat_abc123",
  "name": "与助手的对话",
  "lastMessage": null,
  "characterId": "char_abc123",
  "createdAt": "2025-01-15T08:30:00Z",
  "updatedAt": "2025-01-15T08:30:00Z"
}
```

---

## 更新聊天名称

::endpoint{method="PUT" path="/chats/:chatId" auth}
修改聊天会话的名称。
::

**请求参数：**

::field{name="name" type="string"}
新的会话名称
::

---

## 发送消息

::endpoint{method="POST" path="/chats/:chatId/messages" auth}
向聊天会话发送消息。
::

**请求参数：**

::field{name="content" type="MessageContentDto[]" required}
消息内容数组，支持多种内容类型
::

**消息内容类型：**

| 类型    | 字段                               | 说明           |
| ------- | ---------------------------------- | -------------- |
| `text`  | `content`                          | 文本内容       |
| `image` | `url`, `alt`                       | 图片地址和描述 |
| `file`  | `fileName`, `fileSize`, `mimeType` | 文件信息       |
| `code`  | `content`, `language`              | 代码内容和语言 |

**请求示例：**

```json
{
  "content": [
    {
      "type": "text",
      "content": "请帮我分析这张图片"
    },
    {
      "type": "image",
      "url": "https://example.com/image.jpg",
      "alt": "产品截图"
    }
  ]
}
```

**响应数据：**

```json
{
  "id": "msg_abc123",
  "senderType": "USER",
  "content": [...],
  "createdAt": "2025-01-15T08:30:00Z"
}
```

---

## 获取聊天配置

::endpoint{method="GET" path="/chats/:chatId/config" auth}
获取聊天会话的 LLM 配置参数。
::

**响应数据：**

```json
{
  "temperature": 0.7,
  "maxTokens": 2048,
  "topP": 0.9,
  "systemPrompt": "你是一个友好的 AI 助手..."
}
```

---

## 更新聊天配置

::endpoint{method="PUT" path="/chats/:chatId/config" auth}
修改聊天会话的 LLM 配置参数。
::

**请求参数：**

::field{name="temperature" type="number"}
温度参数 (0-2)，控制随机性
::

::field{name="maxTokens" type="number"}
最大生成 token 数
::

::field{name="topP" type="number"}
Top-P 采样参数 (0-1)
::

::field{name="systemPrompt" type="string"}
系统提示词
::
